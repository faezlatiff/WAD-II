<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Syntax & Operations</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  
    <script>
        // it's a good practice to place functions in <head> section
        function foo() {
            console.log("foo");
        }
    </script>
</head>
<body>
    <div class="m-2 lead bg-info text-center" id="demo"></div>
    <button class="btn btn-primary d-block m-2" onclick="number()">Number</button>
    <button class="btn btn-primary d-block m-2" onclick="findSubStr()">Find a Substring</button>
    <button class="btn btn-primary d-block m-2" onclick="addSortSchools()">Add and Sort Schools</button>
    <button class="btn btn-primary d-block m-2" onclick="updateCheapestFruit()">Update the cheapest fruit</button>
    <button class="btn btn-primary d-block m-2" onclick="generatePassword()">Advanced: Generate Random Password</button>

 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

    <script>
    /*
    Reference: https://www.w3schools.com/js/
    1. Comments: /* vs //
    2. Debug with console.log
    3. Keywords: var, let, if...else, for, for...in, for...of, 
                    continue, break, function, return, try...catch

    4. Naming convention: 
        Recommended: Lower Camel Case ( e.g. firstName )
        Not allowed: Kebab case ( e.g. first-name )

    5. Data types: Number, Boolean, Null, Undefined, String, Array, Object
        -- use typeof operator to check data type
        -- var x = 10.2                     // number
        -- var x = true                     // boolean
        -- var x = null                     // null
        -- var x                            // undefined
        -- var x = "Yournal Drunk"          // string
        -- var x = ["Yournal", 60, true, [], {}]    // array -> a kind of object
        -- var x = { name: "Yournal", age: 60, isMarried: true, prop: {n: 1} }    // object name, prop, key
        
    6. var vs let
        - var & let   : Global scope if defined outside function (and block for let)
        - var & let   : Function scope if defined inside function
        - let         : Block scope if defined inside block
        - var         : No Block scope

    7. for  : loop as long as given condition evaluates to true 
    8. for...in : loop through properties of an object 
    9. for...of : loop through values of an iterable variable 
                        (e.g. Array, String, NodeList etc.) 

                        var nodeList = document.getElementsByClassName('s')

    10. Number Operations: Number(), parseInt(), parseFloat(), isNaN()

    11. String Operations : length, indexOf(), toUpperCase(), trim(), slice(), 
                            substr(), replace(), split(), many more...


    12. Array Operations : legnth, push(), pop(), splice(), join(), 
                            slice(), sort(), reverse(), shift, unshift, many more...

    13. Object: Read/Write operations

    14. Exception Handling with try ... catch ... finally
    
    15. Callback functions : filter, find, forEach, reduce ...

    */

      
    var output = document.getElementById("demo"); // Element object

    // Task 1: State the data types of following variables
    var txt = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+"; 
    var age = 19 // number
    // in JS, we don't have integer, float, double, small int, large int
    var num1 = 10.02; // (in Java/PHP/Python, dt will be float ) but in JS, number
    var num2 = 10; // number
    
    var found = 1 < 0; // boolean
    var numbers = [5, 17, 30, 111, 21, 1, 0]; // array of numbers
    var schools = ["LKCSB", "SOA", "SOL"]; // array of string elements
    var arr = [ 1, "str", true, [1,2,3], {name:"Jack"} ] // array with elements of different data types

    var fruit = {
        name: 'Apple',
        price: 1.5
    } // object
   
    // array is considered as an object data type
    var fruits = [ 
        {name: "Apple", price: 1.5},
        {name: "Orange", price: 2.5},
        {name: "Mango", price: 4.5},
        {name: "Durian", price: 24},
        {name: "Banana", price: 3.8},
        {name: "Peach", price: 2.9}
    ] // array of fruits

    // Task 2: use of isNaN and typeof
    var x = 100 / "y" 
    // try the use of isNaN(x)
    // try console.log(typeof fruits) and check the result
    if (isNaN(x)) {
        console.log("x is NaN")
    }
    console.log(typeof fruits); // object
    console.log(typeof schools) // object

    // Task 3: Demonstrate the difference between var, let, and const
    const GST = 0.07
    var total = 0
    for (let fruit of fruits) {
        // GST = 0.09 // shows TypeError
        total += fruit.price + fruit.price * GST
    }
    console.log("Total cost of fruits: " + total)
    console.log("Apple's price: " + fruit.price)

    // Task xx: create an anonymous function and try to use it
    // isNaN is a built-in function
    var isNumber = function(i) {
        return !isNaN(i);
    } 
    console.log(isNumber(5));            // => true
    console.log(isNumber("A"));          // => false
    console.log(isNumber(NaN));          // => false

    check(isNumber, 5)

    function check(f, num) {
        console.log(f(num))
    }

    // Number 
    function number() {
        /*
            Task 4:
            Implement a function that asks the user to enter a number
            Check if the user input is a number
            If the user input is not a number, alert the message "Your input is not a number"
            Otherwise, display the user input

            Hint: explore Number(), parseInt()
        */
        var num = prompt("Please enter a number");

        num = Number(num);
        // num = Number("10 years") // x = NaN
        // num = parseInt("10 years") // x = 10

        if ( isNaN(num) ) {
            alert("Your input is not a number");
        } else {
            output.innerText = num;
        }

    }
    // String operations
    function findSubStr() {
        /*
            Task 5:
            Write a function that asks the user to enter a string, say str, and two characters, say st and en.
            The function then searches for a substring in txt such that the substring begins with the character st and ends with the character en.
            If the substring is found, display the substring.
            If there is no such substring, display the message "No such substring".

            Hint: explore includes(), indexOf(), slice()
        */
        var str = prompt("Please enter a string");
        var st = prompt("Please enter starting char");
        var en = prompt("Please enter end char");
        var result = "";


        if ( str.includes(st) ) { // Fibonacci
            var idx1 = str.indexOf(st);

            if (str.includes(en, idx1)) {
                var idx2 = str.indexOf(en, idx1);
                result = str.slice(idx1,++idx2);

            } else {
                result = "No such substring";
            }
           
        } else {
            result = "No such substring";
            // alert("No such substring");
        }

        output.innerText = result;
    }

    // Array operations
    function addSortSchools() {
        /* 
            Task 6: 
            Ask the user to enter a new school name, e.g. SOE
            Add the new school name provided by the user into the given array called schools
            Add another school called "SCIS" by replacing an existing school at index 1
            Sort the resulting schools array alphabetically
            Display each school, separated by a colon : (e.g. LKCSB:SCIS:SOE:SOL)
        */
        // given array of schools
        schools = ["LKCSB", "SOA", "SOL"];

        let newSchool = prompt("Please enter a new school");
        schools.push(newSchool); // append at the last
        //schools.unshift(newSchool); // append at the front
        //schools.pop(); // remove last item
        schools.splice(1,1,"SCIS"); // LKCSB,SCIS,SOL,SOE, assuming newSchool = SOE
        //console.log("before sort");
        //console.log(schools);
        schools.sort();
        //schools.reverse(); // this reverses array. i.e., sort in reverse order
        //console.log("after sort");
        //console.log(schools);
        output.innerText = schools.join(":");
    
    }

    // Object read/write, for...of, for..in, callback
    var result = "<ul class='text-start'>";
    function updateCheapestFruit() {
         /*
            Task 7:
            Ask the user to enter a new price for the cheapest fruit
            Find the cheapest fruit in the given array called fruits
            Update the price of the cheapest fruit in the given fruits array with the new price
            Sort the fruits according to their prices
            Display the fruits in a list <ul>

            Hint: find(), sort()

        */
        var fruits = [ 
            {name: "Apple", price: 1.5},
            {name: "Orange", price: 2.5},
            {name: "Mango", price: 4.5},
            {name: "Durian", price: 24},
            {name: "Banana", price: 3.8},
            {name: "Peach", price: 2.9}
        ] // array of fruits

        var cheapest = 9999;
        var newPrice;
        newPrice = prompt("Please enter a price for the cheapest fruit");
        let cheapestFruit;
        
        for (let fruit of fruits) {
            if (fruit.price < cheapest) {
                cheapestFruit = fruit;
                cheapest = fruit.price;
            }
        }
        console.log("Name: " + cheapestFruit.name + "; Price: " + cheapest);

        // let f = fruits.find( element => element.price == cheapest);
        let f = fruits.find( function(element) { return element.price == cheapest} );
        f.price = newPrice;
        console.log(f)
        
        fruits.sort( function(a,b) { 
            return a.price - b.price
        } )
        // sortFruits();
        console.log("sorted fruits")
        console.log(fruits)

        /* for (let fruit of fruits) {
            result += "<li>";
            for (let prop in fruit) {
                result += prop + ": " + fruit[prop] + "; ";
            }
            result += "</li>";
        } */

        fruits.forEach(makeList);
        output.innerHTML = result + "</ul>";
    }

    // Callback 
    function makeList(fruit, index, arr) {
        result += "<li>";
        for (let prop in fruit) {
            result += prop + ": " + fruit[prop] + "; ";
        }
        result += "</li>";
    }
   

    // Advanced: string operation, number operation, and loop
    function generatePassword() {
        /*
            Task 8:
            Generate password that meets the following criteria
                1. password length is equal to the length given by the user
                2. password must contain at least ONE special symbol from !@#$%^&*()_+
                3. password must contain at least ONE number
                4. password must contain at least ONE Uppercase letter
                5. password must contain at least ONE Lowercase letter
        */
        let len = prompt("Please enter the password length (larger than 4)");
        let password = "";
    
        let total = txt.length;
        let hasSymbol = false;
        let hasNumber = false;
        let hasUpper = false;
        let hasLower = false;

        while( !hasSymbol && !hasNumber && !hasUpper && !hasLower ) {

            hasSymbol = false;
            hasNumber = false;
            hasUpper = false;
            hasLower = false;
                
            while ( password.length < len ) {
                // Returns a random integer from 0 to total-1:
                let rIdx = Math.floor(Math.random() * total);
                // console.log(rIdx)
                password += txt[rIdx];  
            }
            console.log(password)

            if (password.search(/[A-Z]/)) {
                hasUpper = true;
                console.log('hasUpper')
            }
            if (password.search(/[a-z]/)) {
                hasLower = true;
                console.log('hasLower')
            }
            if (password.search(/[0-9]/)) {
                hasNumber = true;
                console.log('hasNumber')
            }
            if (password.search(/[!@#$%^&*()_+]/)) {
                hasSymbol = true;
                console.log('hasSymbol')
            } 
        } 

        console.log(password);
        output.innerText = password;
    }



</script>


</body>
</html>